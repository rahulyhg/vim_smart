<?phpclass AccessControlLogModel extends Model{		/* 开门记录	* village_id	小区ID	* @time 2016-06-14	* @author	小邓  <969101097@qq.com>*/	public function getLoglist($village_id=''){		$condition_table=array(			'pigcms_access_control'=>'control',			'pigcms_house_village_user_bind'=>'bind',			'pigcms_access_control_user_log'=> 'Log.class',			'pigcms_house_village'=>'village'		);		if(!empty($village_id)){			$condition_where='log.ac_id=control.ac_id and log.pigcms_id=bind.pigcms_id and log.village_id=village.village_id and log.village_id='.$village_id;			import('@.ORG.merchant_page');	//引入分页		}else{			$condition_where='log.ac_id=control.ac_id and log.pigcms_id=bind.pigcms_id and log.village_id=village.village_id';			import('@.ORG.system_page');	//引入分页		}		$condition_field='control.ac_name,control.village_id,bind.usernum,bind.name,bind.company,bind.phone,log.log_id,log.opdate,village.village_name';        $count_access = D('')->table($condition_table)->where($condition_where)->count();        $p=new Page($count_access,15,'page');		$order='log.opdate desc ';		$access_control_result=D('')->table($condition_table)->where($condition_where)->field($condition_field)->order($order)->limit($p->firstRow .','.$p->listRows)->select();		$return['pagebar']=$p->show();        $return['access_list']=$access_control_result;		return $return;	}		/* 开门记录详情	* log_id	记录ID	* @time 2016-06-14	* @author	小邓  <969101097@qq.com>*/	public function getLoginfo($log_id=''){				$condition_table=array(			'pigcms_access_control'=>'control',			'pigcms_house_village_user_bind'=>'bind',			'pigcms_access_control_user_log'=> 'Log.class',			'pigcms_house_village'=>'village',			'pigcms_access_control_group'=>'group',			'pigcms_company'=>'company',		);		$condition_where='control.ag_id=group.ag_id and company.company_id=bind.company_id and log.ac_id=control.ac_id and log.pigcms_id=bind.pigcms_id and log.village_id=village.village_id and log.log_id='.$log_id;		$condition_field='group.ag_name,control.ac_name,company.company_name,bind.*,control.village_id,log.log_id,log.opdate,village.village_name';		$access_control_result=D('')->table($condition_table)->where($condition_where)->field($condition_field)->find();		return $access_control_result;	}}?>